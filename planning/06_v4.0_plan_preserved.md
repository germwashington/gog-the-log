# Game Design Document v4.0 - Preserved from v2.0

## Important Note
This document contains the complete v2.0 game design specifications, preserved for future implementation. **v4.0 will implement all the features and mechanics described here, but using the v3.0 modular architecture structure.**

**Status**: This is a preservation document. Implementation will begin only after v3.0 modular architecture is complete and working.

**Architecture**: When implemented, v4.0 will use:
- The modular structure from v3.0 (Character Trafficker, Enemy Controller, Readme Guy, Leonardo Da Vinci, Bookwormy Guy, Yawgmoth, Telemetry System)
- All the game mechanics, levels, stages, enemies, weapons, and features specified in this document
- The step-by-step implementation approach from v3.0

---

## Overview
This document provides complete, detailed specifications for implementing the energy shard collection shooter game. Every mechanic, level, stage, enemy, weapon, and visual element is specified here so that an AI coder can implement without making design decisions.

---

## Core Game Structure

### Game Hierarchy
- **Stages**: Major divisions of the game. Each stage has 5 levels and a unique theme/background.
- **Levels**: Individual objectives within a stage. Each level requires collecting 10 energy shards.
- **Objective Completion**: When 10 shards are collected, the level completes, player levels up, and transitions to next level.

### Level Duration
- Each level should take approximately 20-40 seconds to complete (assuming average player skill).
- This keeps the game fast-paced and rewarding.

---

## Energy Shard System

### Shard Collection Objective
- **Target**: Collect exactly 10 energy shards per level.
- **Display**: Show progress counter (e.g., "Shards: 7/10") in HUD.
- **Completion**: When 10 shards collected, immediately trigger level completion.

### Shard Spawn Mechanics

#### Random Falling Shards (70% of shards)
- Shards fall from the top of the screen at random intervals.
- Spawn rate: 1 shard every 2-3 seconds (randomized).
- Spawn position: Random X position across screen width.
- Fall speed: 150-200 pixels per second (randomized per shard).
- Visual: Glowing blue/cyan crystal shape, pulsing light effect.
- Collection: Player must move within 30 pixels to auto-collect.

#### Enemy-Carried Shards (30% of shards)
- Some enemies spawn carrying an energy shard.
- Visual indicator: Enemy has a glowing shard attached/visible on them.
- When enemy is destroyed, shard drops and falls (same mechanics as random shards).
- Enemy types that can carry shards: Any enemy type, randomly determined (30% chance when enemy spawns).
- Shard remains attached to enemy until enemy is destroyed.

### Shard Visual Design
- **Color**: Bright cyan/blue (#00FFFF or #00DDFF) with white core.
- **Size**: 12x12 pixels.
- **Animation**: Pulsing glow effect (scale 1.0 to 1.3, cycle every 0.5 seconds).
- **Trail**: Subtle particle trail as it falls.
- **Collection Effect**: When collected, create small burst of particles and play collection sound.

### Level Completion
- When 10th shard is collected:
  1. Freeze gameplay briefly (0.5 seconds).
  2. Show checkmark animation next to shard counter.
  3. Display "LEVEL COMPLETE!" text (2 seconds).
  4. Show level-up animation/effect.
  5. Apply random stat boost (see Randomness section).
  6. Transition to next level (or stage if level 5 completed).

---

## Stage and Level Structure

### Stage System
- **Total Stages**: 5 stages (can be extended later).
- **Levels per Stage**: 5 levels each.
- **Stage Transition**: After completing level 5 of a stage, show "NEXT STAGE" loading screen, then transition to new stage.

### Stage 1: Deep Space
**Theme**: Classic space with stars and nebula.

**Background Colors**:
- Base: Dark blue (#000428)
- Stars: White/cyan points
- Nebula: Subtle purple/blue gradient overlay
- Parallax layers: 3 layers of stars at different speeds

**Level 1-1** (First level of Stage 1):
- Enemy types: Only "basic" enemies (slow, simple movement straight down).
- Enemy spawn rate: 1 every 3 seconds.
- Enemy speed: 80 pixels/second.
- No enemy shooting.
- Background: Deep space with sparse stars.

**Level 1-2**:
- Enemy types: "basic" enemies (80% spawn rate), "scout" enemies (20% spawn rate).
- Enemy spawn rate: 1 every 2.5 seconds.
- Enemy speed: 90 pixels/second.
- No enemy shooting.
- Background: Same as 1-1, slightly more stars.

**Level 1-3**:
- Enemy types: "basic" (60%), "scout" (30%), "zigzag" (10%).
- Enemy spawn rate: 1 every 2 seconds.
- Enemy speed: 100 pixels/second.
- **Enemies start shooting**: 20% of enemies can shoot basic projectiles.
- Enemy fire rate: 1 shot every 2 seconds.
- Background: Same as 1-2, add subtle nebula glow.

**Level 1-4**:
- Enemy types: "basic" (40%), "scout" (30%), "zigzag" (20%), "fast" (10%).
- Enemy spawn rate: 1 every 1.8 seconds.
- Enemy speed: 110 pixels/second.
- Enemy shooting: 30% of enemies shoot.
- **Enemies split when destroyed**: "scout" and "basic" enemies split into 2 smaller enemies (half size, half health) when destroyed.
- Background: Same as 1-3, more nebula activity.

**Level 1-5** (Mini Boss):
- Enemy types: Regular enemies (reduced spawn: 1 every 3 seconds).
- **Mini Boss**: "Stage1_Boss" spawns at start of level.
  - Health: 500 HP
  - Size: 80x80 pixels
  - Movement: Slow horizontal movement, moves side to side
  - Attacks: Shoots 3-projectile spread every 2 seconds
  - Drops: 3 energy shards when destroyed
  - Visual: Large red/purple ship with glowing core
- Background: Same as 1-4, add boss arena effect (circular boundary glow).

**Stage 1 Transition**:
- Loading screen: "STAGE 2 - ASTEROID FIELD" (2 seconds).
- Fade to black, then fade in new background.

### Stage 2: Asteroid Field
**Theme**: Space with asteroids and rocky debris.

**Background Colors**:
- Base: Dark gray (#1a1a2e)
- Asteroids: Brown/gray shapes scrolling by
- Debris: Small rock particles
- Parallax: Asteroids at different depths

**Level 2-1**:
- Enemy types: "basic" (50%), "zigzag" (30%), "fast" (20%).
- Enemy spawn rate: 1 every 2.2 seconds.
- Enemy speed: 120 pixels/second.
- Enemy shooting: 25% of enemies shoot.
- Background: Asteroid field with large asteroids in background.

**Level 2-2**:
- Enemy types: "zigzag" (40%), "fast" (30%), "fighter" (20%), "sidewinder" (10%).
- Enemy spawn rate: 1 every 2 seconds.
- Enemy speed: 130 pixels/second.
- Enemy shooting: 35% of enemies shoot.
- Background: More dense asteroids, some moving.

**Level 2-3**:
- Enemy types: "zigzag" (30%), "fast" (25%), "fighter" (25%), "sidewinder" (20%).
- Enemy spawn rate: 1 every 1.8 seconds.
- Enemy speed: 140 pixels/second.
- Enemy shooting: 40% of enemies shoot.
- Background: Asteroids closer to foreground, more dynamic.

**Level 2-4**:
- Enemy types: "fast" (30%), "fighter" (25%), "sidewinder" (25%), "hunter" (20%).
- Enemy spawn rate: 1 every 1.6 seconds.
- Enemy speed: 150 pixels/second.
- Enemy shooting: 45% of enemies shoot.
- Enemies split when destroyed: "zigzag" and "fast" enemies split.
- Background: Very dense asteroid field, some asteroids break apart.

**Level 2-5** (Mini Boss):
- Enemy types: Regular enemies (reduced spawn: 1 every 3.5 seconds).
- **Mini Boss**: "Stage2_Boss"
  - Health: 750 HP
  - Size: 90x90 pixels
  - Movement: Zigzag pattern, faster than Stage 1 boss
  - Attacks: Shoots 5-projectile spread every 1.5 seconds, occasional homing shots
  - Drops: 4 energy shards when destroyed
  - Visual: Large brown/gray asteroid-like ship with multiple turrets

**Stage 2 Transition**:
- Loading screen: "STAGE 3 - NEBULA ZONE" (2 seconds).

### Stage 3: Nebula Zone
**Theme**: Colorful nebula clouds and cosmic dust.

**Background Colors**:
- Base: Deep purple (#2d1b69)
- Nebula: Pink/purple/blue gradient clouds
- Cosmic dust: Glowing particles
- Parallax: Nebula clouds at different layers

**Level 3-1**:
- Enemy types: "fighter" (40%), "sidewinder" (30%), "hunter" (25%), "bomber" (5%).
- Enemy spawn rate: 1 every 1.8 seconds.
- Enemy speed: 160 pixels/second.
- Enemy shooting: 50% of enemies shoot.
- Background: Purple/pink nebula with glowing clouds.

**Level 3-2**:
- Enemy types: "sidewinder" (35%), "hunter" (30%), "bomber" (20%), "heavy" (15%).
- Enemy spawn rate: 1 every 1.6 seconds.
- Enemy speed: 170 pixels/second.
- Enemy shooting: 55% of enemies shoot.
- Background: More vibrant nebula, swirling clouds.

**Level 3-3**:
- Enemy types: "hunter" (30%), "bomber" (25%), "heavy" (25%), "spiral" (20%).
- Enemy spawn rate: 1 every 1.5 seconds.
- Enemy speed: 180 pixels/second.
- Enemy shooting: 60% of enemies shoot.
- Background: Intense nebula colors, more particles.

**Level 3-4**:
- Enemy types: "bomber" (30%), "heavy" (25%), "spiral" (25%), "turret" (20%).
- Enemy spawn rate: 1 every 1.4 seconds.
- Enemy speed: 190 pixels/second.
- Enemy shooting: 65% of enemies shoot.
- Enemies split when destroyed: "hunter" and "bomber" enemies split.
- Background: Dense nebula, swirling patterns.

**Level 3-5** (Mini Boss):
- Enemy types: Regular enemies (reduced spawn: 1 every 4 seconds).
- **Mini Boss**: "Stage3_Boss"
  - Health: 1000 HP
  - Size: 100x100 pixels
  - Movement: Spiral pattern, medium speed
  - Attacks: Shoots 7-projectile spread every 1.2 seconds, homing missiles every 3 seconds
  - Drops: 5 energy shards when destroyed
  - Visual: Large purple/pink ship with energy core, nebula-like effects

**Stage 3 Transition**:
- Loading screen: "STAGE 4 - VOID SECTOR" (2 seconds).

### Stage 4: Void Sector
**Theme**: Dark void with energy anomalies.

**Background Colors**:
- Base: Very dark blue/black (#0a0a1a)
- Energy anomalies: Bright cyan/white energy rifts
- Void particles: Glowing white dots
- Parallax: Energy rifts in background

**Level 4-1**:
- Enemy types: "heavy" (35%), "spiral" (30%), "turret" (25%), "elite_hunter" (10%).
- Enemy spawn rate: 1 every 1.5 seconds.
- Enemy speed: 200 pixels/second.
- Enemy shooting: 70% of enemies shoot.
- Background: Dark void with occasional energy rifts.

**Level 4-2**:
- Enemy types: "spiral" (30%), "turret" (30%), "elite_hunter" (25%), "elite_bomber" (15%).
- Enemy spawn rate: 1 every 1.4 seconds.
- Enemy speed: 210 pixels/second.
- Enemy shooting: 75% of enemies shoot.
- Background: More energy rifts, void particles.

**Level 4-3**:
- Enemy types: "turret" (30%), "elite_hunter" (30%), "elite_bomber" (25%), "elite_spiral" (15%).
- Enemy spawn rate: 1 every 1.3 seconds.
- Enemy speed: 220 pixels/second.
- Enemy shooting: 80% of enemies shoot.
- Background: Dense energy rifts, more void activity.

**Level 4-4**:
- Enemy types: "elite_hunter" (35%), "elite_bomber" (30%), "elite_spiral" (25%), "heavy" (10%).
- Enemy spawn rate: 1 every 1.2 seconds.
- Enemy speed: 230 pixels/second.
- Enemy shooting: 85% of enemies shoot.
- Enemies split when destroyed: "elite_hunter" and "elite_bomber" split.
- Background: Intense energy rifts, void storm effect.

**Level 4-5** (Mini Boss):
- Enemy types: Regular enemies (reduced spawn: 1 every 4.5 seconds).
- **Mini Boss**: "Stage4_Boss"
  - Health: 1500 HP
  - Size: 110x110 pixels
  - Movement: Fast zigzag with teleportation (brief invulnerability)
  - Attacks: Shoots 9-projectile spread every 1 second, homing missiles every 2 seconds, energy burst every 5 seconds
  - Drops: 6 energy shards when destroyed
  - Visual: Large dark ship with energy core, void energy effects

**Stage 4 Transition**:
- Loading screen: "STAGE 5 - FINAL CONFRONTATION" (2 seconds).

### Stage 5: Final Confrontation
**Theme**: Epic final battle arena.

**Background Colors**:
- Base: Dark red/purple (#2d0a1a)
- Energy storms: Red/orange/yellow energy
- Battle debris: Glowing wreckage
- Parallax: Epic battle scene layers

**Level 5-1**:
- Enemy types: "elite_hunter" (40%), "elite_bomber" (35%), "elite_spiral" (25%).
- Enemy spawn rate: 1 every 1.2 seconds.
- Enemy speed: 240 pixels/second.
- Enemy shooting: 90% of enemies shoot.
- Background: Epic battle arena, energy storms.

**Level 5-2**:
- Enemy types: "elite_bomber" (40%), "elite_spiral" (35%), "elite_hunter" (25%).
- Enemy spawn rate: 1 every 1.1 seconds.
- Enemy speed: 250 pixels/second.
- Enemy shooting: 95% of enemies shoot.
- Background: More intense battle scene.

**Level 5-3**:
- Enemy types: "elite_spiral" (40%), "elite_hunter" (35%), "elite_bomber" (25%).
- Enemy spawn rate: 1 every 1 second.
- Enemy speed: 260 pixels/second.
- Enemy shooting: 100% of enemies shoot (all enemies shoot).
- Background: Maximum intensity battle arena.

**Level 5-4**:
- Enemy types: Mix of all elite types (equal distribution).
- Enemy spawn rate: 1 every 0.9 seconds.
- Enemy speed: 270 pixels/second.
- Enemy shooting: 100% of enemies shoot.
- Enemies split when destroyed: All elite enemies split.
- Background: Chaos battle scene, maximum effects.

**Level 5-5** (Final Boss):
- Enemy types: Regular enemies (reduced spawn: 1 every 5 seconds).
- **Final Boss**: "Stage5_FinalBoss"
  - Health: 2500 HP
  - Size: 120x120 pixels
  - Movement: Complex pattern (figure-8, spiral, teleportation)
  - Attacks: 
    - 12-projectile spread every 0.8 seconds
    - Homing missiles every 1.5 seconds
    - Energy burst every 4 seconds
    - Screen-wide attack every 10 seconds
  - Drops: 10 energy shards when destroyed (completes level)
  - Visual: Massive dark red/purple ship with multiple energy cores, epic boss effects
  - Phases: Boss has 3 phases (at 75%, 50%, 25% health) with different attack patterns

**Stage 5 Completion**:
- Victory screen with final score.
- Easter egg trigger if applicable.

---

## Major Boss System

### Major Boss Spawning
- **Frequency**: One major boss appears every 2 stages (after Stage 2, Stage 4, and Stage 5).
- **Boss Types**: 
  - **Major Boss 1** (After Stage 2): "Asteroid_Crusher"
  - **Major Boss 2** (After Stage 4): "Void_Reaper"
  - **Major Boss 3** (After Stage 5): Final boss (already described above)

### Major Boss 1: Asteroid Crusher
- **Spawn**: After completing Stage 2, Level 5.
- **Health**: 2000 HP
- **Size**: 130x130 pixels
- **Movement**: Slow but steady, moves in large arcs
- **Attacks**:
  - Throws asteroid projectiles (5 at a time) every 2 seconds
  - Ground slam attack every 5 seconds (creates shockwave)
  - Spawns 3 regular enemies every 8 seconds
- **Drops**: 8 energy shards when destroyed
- **Visual**: Massive asteroid-like ship with multiple turrets, rocky exterior
- **Background**: Special boss arena with asteroid debris

### Major Boss 2: Void Reaper
- **Spawn**: After completing Stage 4, Level 5.
- **Health**: 3000 HP
- **Size**: 140x140 pixels
- **Movement**: Fast teleportation, appears in different locations
- **Attacks**:
  - Void energy blasts (8-projectile spread) every 1.5 seconds
  - Teleportation strike every 4 seconds
  - Summons 5 elite enemies every 10 seconds
  - Screen-wide void wave every 12 seconds
- **Drops**: 10 energy shards when destroyed
- **Visual**: Large dark energy entity with void effects, shifting form
- **Background**: Void dimension with energy anomalies

---

## Weapon System

### Weapon Evolution Mechanics
- **Base Weapon**: Player starts with a basic weapon (e.g., "Pistol").
- **Weapon Upgrades**: Same weapon can be upgraded through levels (Level 1, 2, 3, 4, 5).
- **New Weapon Drops**: Every 3-4 levels, a new weapon falls from the top of the screen.
- **Weapon Reset**: When a new weapon is collected, it resets to Level 1, but with a general power boost.

### Weapon Upgrade Levels
Each weapon has 5 upgrade levels:

**Level 1** (Base):
- Basic stats (defined per weapon type)

**Level 2**:
- +25% fire rate
- +20% damage
- Visual: Slight glow effect

**Level 3**:
- +50% fire rate (from base)
- +40% damage (from base)
- +1 projectile (if applicable)
- Visual: Enhanced glow, particle effects

**Level 4**:
- +75% fire rate (from base)
- +60% damage (from base)
- +2 projectiles (if applicable)
- Visual: Strong glow, trail effects

**Level 5** (Max):
- +100% fire rate (from base)
- +80% damage (from base)
- +3 projectiles (if applicable)
- Special ability (weapon-specific)
- Visual: Maximum glow, special effects

### Weapon Types and Specifications

#### 1. Pistol (Starting Weapon)
- **Base Stats** (Level 1):
  - Fire rate: 300ms between shots
  - Damage: 20 per bullet
  - Projectiles: 1
  - Bullet speed: 500 pixels/second
  - Bullet size: 4x8 pixels
  - Color: White/cyan
- **Level 5 Special**: Piercing shot (goes through 2 enemies)

#### 2. Machine Gun
- **Base Stats** (Level 1):
  - Fire rate: 150ms between shots
  - Damage: 15 per bullet
  - Projectiles: 1
  - Bullet speed: 600 pixels/second
  - Bullet size: 3x6 pixels
  - Color: Yellow/orange
- **Level 5 Special**: Rapid fire mode (2x fire rate for 3 seconds)

#### 3. Bazooka
- **Base Stats** (Level 1):
  - Fire rate: 800ms between shots
  - Damage: 80 per explosion
  - Projectiles: 1 (explosive)
  - Bullet speed: 400 pixels/second
  - Bullet size: 12x12 pixels (explosion radius: 40 pixels)
  - Color: Red/orange
- **Level 5 Special**: Explosion chain (explosions trigger smaller explosions)

#### 4. Sniper Rifle
- **Base Stats** (Level 1):
  - Fire rate: 1000ms between shots
  - Damage: 100 per bullet
  - Projectiles: 1
  - Bullet speed: 800 pixels/second
  - Bullet size: 2x20 pixels (long, thin)
  - Color: Blue/cyan
- **Level 5 Special**: Critical hit chance (50% chance for 2x damage)

#### 5. Glock
- **Base Stats** (Level 1):
  - Fire rate: 250ms between shots
  - Damage: 25 per bullet
  - Projectiles: 1
  - Bullet speed: 550 pixels/second
  - Bullet size: 4x7 pixels
  - Color: Silver/white
- **Level 5 Special**: Double tap (fires 2 shots in quick succession)

#### 6. AK-47
- **Base Stats** (Level 1):
  - Fire rate: 200ms between shots
  - Damage: 30 per bullet
  - Projectiles: 1
  - Bullet speed: 580 pixels/second
  - Bullet size: 4x8 pixels
  - Color: Brown/orange
- **Level 5 Special**: Burst fire (fires 3-shot burst every shot)

#### 7. Shotgun
- **Base Stats** (Level 1):
  - Fire rate: 600ms between shots
  - Damage: 40 per pellet (5 pellets)
  - Projectiles: 5 (spread pattern)
  - Bullet speed: 450 pixels/second
  - Bullet size: 3x5 pixels per pellet
  - Color: Green/yellow
- **Level 5 Special**: Wide spread (7 pellets, wider angle)

#### 8. Laser Rifle
- **Base Stats** (Level 1):
  - Fire rate: 400ms between shots
  - Damage: 50 per beam
  - Projectiles: 1 (continuous beam, 0.2 second duration)
  - Bullet speed: Instant (beam)
  - Bullet size: 3x30 pixels (beam)
  - Color: Pink/magenta
- **Level 5 Special**: Extended beam (longer duration, pierces enemies)

### Weapon Drop Mechanics
- **Drop Frequency**: Every 3-4 levels (randomized: 30% chance every level after level 3, guaranteed by level 4).
- **Drop Location**: Falls from top of screen at random X position.
- **Fall Speed**: 200 pixels/second.
- **Visual**: Weapon icon/name visible, glowing effect, pulsing.
- **Collection**: Player must move within 40 pixels to collect.
- **Restriction**: Current weapon never drops (if player has Machine Gun, Machine Gun won't drop).
- **Previous Weapons**: Previous weapons CAN drop again (e.g., if player had Pistol, then Machine Gun, Pistol can drop again).
- **Power Scaling**: When a new weapon is collected, it starts at Level 1 but with stats boosted by: `(current_stage_number * 0.1) + (total_levels_completed * 0.05)`. This ensures later weapons are stronger even at Level 1.

### Weapon Visual Indicators
- **HUD Display**: Show current weapon name and level (e.g., "Machine Gun Lv.3").
- **Weapon Icon**: Small icon next to weapon name.
- **Upgrade Notification**: When weapon levels up, show brief "WEAPON UPGRADED!" message.

---

## Enemy Behavior Progression

### Enemy Movement Patterns by Level

**Level 1** (First level of each stage):
- All enemies: Slow, simple movement straight down.
- Speed multiplier: 0.8x base speed.
- No special patterns.

**Level 2**:
- 50% of enemies: Zigzag movement pattern.
- Zigzag amplitude: 30-50 pixels side to side.
- Zigzag frequency: Complete cycle every 1-2 seconds.
- Other 50%: Still straight down.

**Level 3**:
- All enemies from Level 2 patterns.
- **Enemies start shooting**: 30-50% of enemies can shoot projectiles.
- Enemy fire rate: 1 shot every 2-3 seconds (varies by enemy type).
- Enemy projectiles: Basic, slow-moving, damage 15-25.

**Level 4**:
- All enemies from Level 3.
- **Enemies split when destroyed**: Certain enemy types split into 2 smaller enemies.
- Split enemies: Half size, half health, same movement pattern.
- Which enemies split: Determined by stage (see stage-specific details above).

**Level 5** (Mini Boss level):
- Regular enemies spawn at reduced rate.
- Mini boss spawns at start of level.
- Regular enemies continue spawning during boss fight.
- Boss has unique movement and attack patterns.

### Enemy Types Reference

**Basic Enemy**:
- Health: 30 HP
- Speed: 100 pixels/second
- Size: 30x30 pixels
- Points: 100
- Can shoot: No (unless level 3+)
- Splits: Yes (in level 4+)

**Scout Enemy**:
- Health: 10 HP
- Speed: 120 pixels/second
- Size: 20x20 pixels
- Points: 50
- Can shoot: No (unless level 3+)
- Splits: Yes (in level 4+)

**Zigzag Enemy**:
- Health: 25 HP
- Speed: 150 pixels/second
- Size: 30x30 pixels
- Points: 180
- Movement: Zigzag pattern
- Can shoot: Yes (if level 3+)
- Splits: Yes (in level 4+)

**Fast Enemy**:
- Health: 15 HP
- Speed: 250 pixels/second
- Size: 25x25 pixels
- Points: 150
- Can shoot: Yes (if level 3+)
- Splits: Yes (in level 4+)

**Fighter Enemy**:
- Health: 20 HP
- Speed: 150 pixels/second
- Size: 25x25 pixels
- Points: 100
- Can shoot: Yes (if level 3+)
- Splits: No

**Sidewinder Enemy**:
- Health: 20 HP
- Speed: 200 pixels/second
- Size: 28x28 pixels
- Points: 160
- Movement: Side-to-side pattern
- Can shoot: Yes (if level 3+)
- Splits: No

**Hunter Enemy**:
- Health: 40 HP
- Speed: 180 pixels/second
- Size: 35x35 pixels
- Points: 250
- Movement: Tracks player position
- Can shoot: Yes (homing shots)
- Splits: Yes (in level 4+)

**Bomber Enemy**:
- Health: 80 HP
- Speed: 80 pixels/second
- Size: 45x45 pixels
- Points: 350
- Can shoot: Yes (bomb spread)
- Splits: Yes (in level 4+)

**Heavy Enemy**:
- Health: 120 HP
- Speed: 60 pixels/second
- Size: 50x50 pixels
- Points: 400
- Can shoot: Yes (triple shot)
- Splits: No

**Spiral Enemy**:
- Health: 35 HP
- Speed: 120 pixels/second
- Size: 32x32 pixels
- Points: 220
- Movement: Spiral pattern
- Can shoot: Yes (spiral shot pattern)
- Splits: No

**Turret Enemy**:
- Health: 70 HP
- Speed: 0 (stationary)
- Size: 34x34 pixels
- Points: 300
- Movement: Moves with background scroll
- Can shoot: Yes (homing shots)
- Splits: No

**Elite Hunter**:
- Health: 80 HP
- Speed: 220 pixels/second
- Size: 40x40 pixels
- Points: 500
- Movement: Aggressive player tracking
- Can shoot: Yes (double homing shots)
- Splits: Yes (in level 4+)

**Elite Bomber**:
- Health: 150 HP
- Speed: 100 pixels/second
- Size: 55x55 pixels
- Points: 600
- Can shoot: Yes (massive bomb spread)
- Splits: Yes (in level 4+)

**Elite Spiral**:
- Health: 60 HP
- Speed: 150 pixels/second
- Size: 38x38 pixels
- Points: 450
- Movement: Enhanced spiral pattern
- Can shoot: Yes (5-projectile spiral)
- Splits: No

---

## Visual Effects and Transitions

### Level Completion Effects
- **Checkmark Animation**: Large checkmark appears next to shard counter, scales from 0 to 1.2, then settles at 1.0.
- **Level Complete Text**: "LEVEL COMPLETE!" appears in center, fades in, stays 2 seconds, fades out.
- **Particle Burst**: Explosion of particles from player position (50-100 particles).
- **Screen Flash**: Brief white flash (0.1 seconds, 30% opacity).
- **Stat Boost Display**: Show "+X Damage" or "+X Speed" etc. in corner (2 seconds).

### Stage Transition Effects
- **Loading Screen**: 
  - Black screen with text: "STAGE [N] - [STAGE NAME]"
  - Text appears with fade-in (1 second)
  - Stays visible (2 seconds total)
  - Fade to black (0.5 seconds)
  - Fade in new stage background (1 second)
- **Background Transition**: Smooth fade between old and new background colors.
- **Particle Reset**: Clear all particles, reset particle systems for new stage.

### Visual Changes Per Stage
- **Background Colors**: Completely different color palette (see stage descriptions).
- **Parallax Layers**: Different number and speed of parallax layers.
- **Particle Effects**: Different particle types and colors.
- **Lighting**: Different ambient lighting (brighter/darker, different hues).
- **Screen Effects**: Optional screen shaders/filters per stage.

### Random Visual Elements
- **Color Palette Variations**: Each stage can have 2-3 color palette variants that randomly activate.
- **Particle Density**: Random variation in particle count (80%-120% of base).
- **Background Element Positions**: Random positioning of background elements (asteroids, nebula clouds, etc.).

---

## Randomness System

### Random Enemy Spawn Patterns
- **Spawn Timing**: Base spawn rate ±20% random variation.
- **Spawn Position**: Random X position within screen bounds (with 20-pixel margin from edges).
- **Enemy Type Selection**: Weighted random based on level specifications (see stage/level details).

### Random Pickup Spawns
- **Health Pickups**: 5% chance when enemy destroyed (if not carrying shard).
- **Ammo Pickups**: Not applicable (weapons have unlimited ammo).
- **Temporary Power-ups**: 3% chance when enemy destroyed (speed boost, damage boost, etc., duration 5-10 seconds).

### Random Color Palettes
- Each stage has 2-3 predefined color palette variants.
- Randomly select one at stage start.
- Variants have same theme but different hue/saturation.

### Random Stat Boosts on Level Up
When level completes, apply ONE random stat boost:
- **Damage Boost**: +5% to +15% damage (random)
- **Speed Boost**: +5% to +15% movement speed (random)
- **Fire Rate Boost**: +5% to +15% fire rate (random)
- **Health Boost**: +10 to +30 max health (random)
- **Collection Range Boost**: +5 to +15 pixels collection range (random)

Each boost is permanent for the rest of the game session.

### Random Weapon Drop Timing
- After level 3, each level has 30% chance to spawn weapon drop.
- Guaranteed weapon drop by level 4 if none spawned yet.
- This creates variation in when players get new weapons.

---

## Player Progression

### Leveling System
- **Level Up**: Occurs when completing a level (collecting 10 shards).
- **Level Display**: Show current level number in HUD.
- **Level Benefits**: 
  - Random stat boost (see Randomness section)
  - Weapon upgrade (if applicable)
  - Visual feedback (particles, effects)

### Stat Tracking
- **Total Shards Collected**: Track across all levels.
- **Enemies Destroyed**: Counter in HUD.
- **Current Stage/Level**: Display "Stage X - Level Y" in HUD.
- **Weapon Level**: Display current weapon and level.

### Persistent Upgrades
- All stat boosts from level-ups are permanent.
- Weapon levels persist until new weapon is collected (then reset to Level 1 with power scaling).
- Player health can be increased by stat boosts.

---

## HUD and UI Elements

### Main HUD Elements
1. **Health Bar**: Top-left, shows current/max health.
2. **Shard Counter**: Top-center, shows "Shards: X/10" with progress bar.
3. **Level Display**: Top-right, shows "Stage X - Level Y".
4. **Weapon Display**: Below level, shows "Weapon: [Name] Lv.[Level]".
5. **Score**: Optional, top-right corner.
6. **Enemies Destroyed**: Optional counter.

### Level Completion UI
- **Checkmark**: Appears next to shard counter when level completes.
- **Level Complete Text**: Large text in center of screen.
- **Stat Boost Notification**: Small text in corner showing what stat was boosted.

### Stage Transition UI
- **Loading Screen**: Full-screen overlay with stage name.
- **Progress Indicator**: Optional loading bar or spinner.

### Weapon Drop UI
- **Weapon Icon**: Visible on falling weapon.
- **Collection Prompt**: Optional "Press [Key] to collect" or auto-collect on proximity.

---

## Audio Specifications

### Sound Effects
- **Shard Collection**: Short, pleasant chime (high pitch, 0.2 seconds).
- **Level Complete**: Triumphant sound (0.5 seconds).
- **Weapon Upgrade**: Power-up sound (0.3 seconds).
- **Weapon Drop Spawn**: Noticeable sound when weapon appears (0.4 seconds).
- **Enemy Destroyed**: Explosion sound (varies by enemy size).
- **Player Hit**: Damage sound (0.2 seconds).
- **Boss Spawn**: Dramatic sound (1 second).
- **Boss Defeated**: Epic victory sound (1.5 seconds).

### Music
- **Stage Music**: Different background music track per stage (optional, can be simple loops).
- **Boss Music**: Intense music during boss fights.
- **Victory Music**: Short victory fanfare on stage completion.

---

## Technical Implementation Notes

### Game State Management
- **States**: Start, Playing, Level Complete, Stage Transition, Boss Fight, Game Over, Victory.
- **State Transitions**: Clear state machine with defined transitions.

### Collision Detection
- **Shard Collection**: Circle-based collision (30-40 pixel radius from player center).
- **Weapon Collection**: Circle-based collision (40 pixel radius).
- **Bullet-Enemy**: Rectangle-based collision.
- **Enemy-Player**: Rectangle-based collision.

### Performance Considerations
- **Object Pooling**: Reuse particle and bullet objects.
- **Enemy Limit**: Maximum 20 enemies on screen at once.
- **Particle Limit**: Maximum 200 particles at once.
- **Cleanup**: Remove off-screen objects promptly.

### Save System (Optional)
- Save progress: Current stage, level, weapon, stats.
- Load on game start if save exists.

---

## Easter Egg: "6-7" Reference

### Trigger Condition
- When player reaches exactly 67 total shards collected (across all levels).
- OR when player types "6-7" on keyboard during gameplay.
- OR when player completes level 6-7 (if such level exists in extended content).

### Effect
- Screen flashes with "6-7" text.
- Confetti/particle explosion.
- Playful message: "You found it: 6-7 — payback is a hug!" (or similar harmless message).
- Brief animation (2-3 seconds).
- Game continues normally.

---

## Implementation Priority

### Phase 1: Core Systems
1. Energy shard system (spawning, collection, counter)
2. Level completion system
3. Basic stage/level structure
4. Player movement and basic weapon

### Phase 2: Progression
5. Stage transitions
6. Weapon system (drops, upgrades)
7. Enemy behavior progression
8. Mini bosses

### Phase 3: Polish
9. Visual effects and transitions
10. Randomness systems
11. Major bosses
12. Audio integration

### Phase 4: Final Touches
13. HUD polish
14. Easter egg
15. Balancing and testing

---

## Notes for AI Coder

- This document specifies EVERY detail needed for implementation.
- If something is not specified here, use reasonable defaults based on similar specified elements.
- All numbers (damage, health, speeds, etc.) are exact specifications - implement as written.
- Visual descriptions are guidelines - use similar aesthetics if exact colors aren't available.
- Test each stage/level individually before moving to next.
- Balance may need adjustment during playtesting, but start with these exact values.
- **When implementing v4.0, use the v3.0 modular architecture structure.**
- **All features described here will be implemented using the modular system from v3.0.**

---

## End of Document

This completes the detailed game design document. All systems, mechanics, levels, stages, enemies, weapons, and visual elements are fully specified for implementation in v4.0 using the v3.0 modular architecture.

